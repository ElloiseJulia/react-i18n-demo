# 网页语种切换技术方案报告

## 一、任务背景
我们Fusion的技术栈包括：
- **前端**：React, React Router, Ant Design, Echarts
- **后端**：.NET
- **部署**：IIS, Windows Server, Azure

由于没有具体的前后端代码，我创建了一个简易版的 VAFusion UI demo 来演示和验证我的技术方案。

## 二、技术方案概述

我采用 **React Context API + TypeScript + .NET Web API** 的方案来实现语种切换功能。

### 方案特点

1. **轻量级**：使用 React 原生 Context API，无需引入第三方 i18n 库
2. **类型安全**：使用 TypeScript 提供完整的类型检查
3. **前后端分离**：支持从本地 JSON 文件或 .NET API 获取翻译数据
4. **易于集成**：代码结构清晰，可以直接集成到现有项目

## 三、实现思路

### 3.1 架构设计

```
前端（React + TypeScript）
├── TranslationProvider（Context Provider）
│   └── 管理全局语言状态和翻译数据
├── useTranslate Hook
│   └── 提供翻译函数 t() 和语言切换功能
└── 组件使用翻译
    └── 通过 t("文件名.键名") 获取翻译文本

后端（.NET Web API）
└── TranslationController
    ├── GET /api/translation/{language} - 获取翻译数据
    ├── GET /api/translation/languages - 获取可用语言
    └── POST /api/user/language - 保存用户语言偏好
```

### 3.2 核心实现

**前端核心代码：**

1. **TranslationProvider**：使用 React Context 管理全局语言状态
2. **useTranslate Hook**：封装翻译逻辑，提供 `t()` 函数
3. **翻译文件**：按功能模块组织 JSON 文件（如 `home.json`, `common.json`）

**后端核心代码：**

1. **TranslationController**：提供 RESTful API 接口
2. **CORS 配置**：允许前端跨域访问
3. **数据结构**：支持嵌套的翻译键值对

### 3.3 数据流

1. 用户点击语言选择器
2. 调用 `setLanguage()` 更新 Context 中的语言状态
3. 所有使用 `useTranslate()` 的组件自动重新渲染
4. `t()` 函数返回对应语言的翻译文本

## 四、Demo 项目说明

### 4.1 项目结构

我创建了一个简易版的 VAFusion UI demo，包含：

- **3 个演示页面**：
  - Overview（概览页面）- 展示统计数据
  - Data Report（数据报告页面）- 展示表格数据
  - Campaign（活动管理页面）- 展示卡片布局

- **技术栈匹配**：
  - React + TypeScript
  - React Router（多页面路由）
  - Ant Design（UI 组件库）
  - .NET 后端 API（已提供）

### 4.2 功能演示

Demo 项目展示了以下功能：

1. **语种切换**：在英文和中文之间实时切换
2. **多页面支持**：所有页面的内容都会根据语言切换
3. **Ant Design 集成**：UI 组件也会自动切换语言
4. **路由导航**：侧边栏菜单支持多页面导航

### 4.3 运行方式

```bash
# 安装依赖
npm install

# 启动前端开发服务器
npm run dev

# 访问 http://localhost:5173
```

后端 API（可选）：
```bash
cd dotnet-backend
dotnet restore
dotnet run
```

## 五、集成到现有项目

### 5.1 前端集成步骤

1. **复制翻译系统文件**
   - 将 `src/i18n/` 文件夹复制到现有项目
   - 包含：TranslationProvider, useTranslate, 翻译文件等

2. **在 App.tsx 中集成**
   ```tsx
   import { TranslationProvider } from "./i18n";
   import { ConfigProvider } from "antd";
   import zhCN from "antd/locale/zh_CN";
   import enUS from "antd/locale/en_US";
   
   function App() {
     return (
       <TranslationProvider>
         <ConfigProvider locale={language === "zh" ? zhCN : enUS}>
           {/* 你的应用 */}
         </ConfigProvider>
       </TranslationProvider>
     );
   }
   ```

3. **在组件中使用**
   ```tsx
   import { useTranslate } from "../i18n";
   
   function MyComponent() {
     const { t } = useTranslate();
     return <Button>{t("common.save")}</Button>;
   }
   ```

### 5.2 后端集成步骤

1. **将 TranslationController 添加到现有 .NET 项目**
   - 复制 `dotnet-backend/TranslationController.cs` 到现有项目
   - 配置 CORS 允许前端域名访问

2. **配置翻译数据**
   - 可以将翻译数据存储在数据库中
   - 或者使用配置文件/JSON 文件

3. **前端连接 API（可选）**
   - 使用 `TranslationProviderWithApi` 替代 `TranslationProvider`
   - 配置 API 基础 URL

### 5.3 添加新语言

1. 在 `src/i18n/` 下创建新语言文件夹（如 `fr/`）
2. 创建对应的 JSON 翻译文件
3. 在 `TranslationProvider.tsx` 中导入并添加到配置
4. 在语言选择器中添加选项

## 六、技术方案优势
1. **零额外依赖**：仅使用 React 原生功能，不增加项目体积
2. **类型安全**：TypeScript 提供编译时类型检查
3. **灵活的数据源**：支持本地文件和 API 两种模式
4. **易于维护**：代码结构清晰，翻译文件按模块组织
5. **性能优化**：Context 只在语言切换时触发重渲染

## 七、与现有技术栈的匹配
- React
- React Router
- Ant Design
- TypeScript
- .NET
- IIS/Windows Server

---

**项目文件说明：**
- `src/i18n/` - 翻译系统核心代码
- `dotnet-backend/` - .NET 后端 API 代码
- `src/pages/` - 演示页面
- `演示说明.md` - 详细的运行和集成说明

